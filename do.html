<html>
<head>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/ipify/3.0.0/ipify.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/ua-parser-js/0.7.28/ua-parser.min.js"></script>
<script type="text/javascript">
// This is the JavaScript code for the web app
// You can change it as you wish
// You can also use the code from the previous example

// This function is called when the web app is loaded
// This is the JavaScript code for the web app
// You can change it as you wish
// You can also use the code from the previous example

// This function is called when the web app is loaded
function onWebAppLoad() {
  // You can add any code here to initialize your web app
  // For example, you can change the title or the background color of the web app
  document.title = "My Web App";
  document.body.style.backgroundColor = "lightblue";

  // You can use the ipify function to get the ip address of the user
  ipify(function(err, ip) {
    if (err) {
      // Handle error
      console.error(err);
    } else {
      // Do something with ip
      console.log("User IP: " + ip);
      document.getElementById("ip").innerHTML = "User IP: " + ip;
    }
  });

  // You can use the UAParser function to get the device information of the user from the useragent string
  var parser = new UAParser();
  var result = parser.getResult();
  var device = result.device; // This is the device object that contains the device model, type and vendor
  var browser = result.browser; // This is the browser object that contains the browser name and version
  var os = result.os; // This is the os object that contains the os name and version
  console.log("User Device: " + JSON.stringify(device));
  console.log("User Browser: " + JSON.stringify(browser));
  console.log("User OS: " + JSON.stringify(os));
  document.getElementById("device").innerHTML = "User Device: " + JSON.stringify(device);
  document.getElementById("browser").innerHTML = "User Browser: " + JSON.stringify(browser);
  document.getElementById("os").innerHTML = "User OS: " + JSON.stringify(os);
}

// This function is called when the user interacts with the web app
function onWebAppEvent(event) {
  // You can add any code here to handle the user input from the web app
  // For example, you can change the content or the style of the web app
  document.getElementById("content").innerHTML = "You clicked on " + event.data;
  document.getElementById("content").style.color = "red";

  // You can also send data from the web app to the bot using the WebAppEvent class
  // For example, you can send the user id, the user name, the ip address and the device information to the bot
  var user = event.user; // This is the user object that contains the user id and the user name
  var ip = document.getElementById("ip").innerHTML; // This is the ip address of the user
  var device = document.getElementById("device").innerHTML; // This is the device information of the user
  var browser = document.getElementById("browser").innerHTML; // This is the browser information of the user
  var os = document.getElementById("os").innerHTML; // This is the os information of the user
  var data = {user_id: user.id, user_name: user.username, ip_address: ip, device_info: device, browser_info: browser, os_info: os}; // This is the data object that contains all the information
  var webAppEvent = new WebAppEvent(data); // This is the web app event object that contains the data object
  webAppEvent.send(); // This sends the web app event to the bot
}

</script>
</head>
<body>
<div id="content">This is my web app</div>
<button onclick="onWebAppEvent({data: 'Button 1'})">Button 1</button>
<button onclick="onWebAppEvent({data: 'Button 2'})">Button 2</button>
</body>
</html>
